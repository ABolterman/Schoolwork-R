---
title: "Acceptance Rejection Sampling"
author: Abigail Bolterman
output:
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```


# Exercise Acceptance-Rejection Method, and Newton-Raphson Method

**a) Use the acceptance-rejection method to generate random numbers from a beta distribution with shape parameters 2 and 4. Plot the distributions produced using the acceptance-rejection method and the true distribution in the same plot. Also compare the 2.5% and 97.5% quantiles of the empirical distribution and the theoretical distribution, and briefly comment on the results.**

The pdf of the beta distrubution with shape parameters 2 and 4 is $f(x) = constant*x^{2-1}*(1-x)^{4-1}$.
```{r}
f = function(x) x*(1-x)**3
a = integrate(f, 0,1)
a$value
```
Since the integral of the pdf needs to equal 1, the constant is 20, making the pdf $f(x) = 20x(1-x)^{3}$. If g(x) is the Uniform(0,1) density, then f(x)/g(x) <= 20.

```{r}
target_sample_size = 1000
number_of_accepted_samples = 0
y = rep(0, target_sample_size)

while(number_of_accepted_samples < target_sample_size){ 
  u = runif(1)
  x = runif(1)
  if(u < x*(1-x)**3 ){
    number_of_accepted_samples = number_of_accepted_samples + 1
    y[number_of_accepted_samples] = x
  }
}

x = rbeta(1000, 2, 4)
betaDf = data.frame(Vals = c(x, y), Key = c(rep('Beta(2, 4)', length(x)), rep('Acceptance-Rejection Method Result', length(y))))
ggplot(data = betaDf) +
  geom_density(aes(x = Vals, color = Key), size = 1.25, bw = 0.15)
```

```{r}
# Empirical Quantiles:
quantile(y, 0.025); quantile(y, 0.975)

# Theoretical Quantiles
qbeta(0.025, 2, 4); qbeta(0.975, 2, 4)
```
The empirical and theoretical quantiles are very close. The two density graphs are very close as well.

b) Use the Newton-Raphson method to find the roots of f(x) = x^3 - 2x - 5.

```{r}
# Answer:

```

