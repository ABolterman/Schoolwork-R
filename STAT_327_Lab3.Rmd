---
title: "STAT 327 - Probability Distributions"
author: "Abigail Bolterman"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reshape2)
library(cowplot)
```


#3. Exercises

## 3.1 Practice Writing Functions

a) Write a function that converts a temperature in Celsius to Fahrenheit. Use the following conversion equation: F = 32 + (9/5)*C. Test your function 3 times with any Celsius values of your choice.

```{r}
# Answer:
c_to_f = function(temperature){
  return(32+(9/5)*temperature)
}

c_to_f(0)
c_to_f(100)
c_to_f(-40)

```

b) Write a function that simulates a coin flip n number of times and returns the number of flips that resulted in tails.

```{r}
# Answer:
# 0 = heads, 1 = tails
flip_coin_tails = function(n){
  return(sum(rbinom(n, 1, .5)))
}

flip_coin_tails(100)

```

## 3.2 dplyr Practice

For parts c) and d), consider the dataset "storms", which is already part of R.

c) Filter the data to only include observations during or after the year 2000.

```{r}
data(storms)
# Answer:
storms_post_2000 = storms %>%
  filter(year >= 2000)

head(storms_post_2000)
```

d) Summarize the mean of wind and pressure broken down by storm status.

```{r}
# Answer:
storm_means = storms %>%
  group_by(status) %>%
  summarise("mean wind" = mean(wind), "mean pressure" = mean(pressure))

head(storm_means)

```

## 3.3 PDFs and CDFs

e) Plot the PDF and CDF of a Weibull distribution with shape parameter 1 and scale parameter 1.5 (Type ?Weibull into the console for help with the functions in R). You do not need to put the two plots side by side, you can produce two separate plots.

```{r}
# Answer:
x <- rweibull(1000, shape = 1, scale = 1.5)
y_pdf <- dweibull(x, 1, 1.5)
y_cdf <- pweibull(x, 1, 1.5)


weibull_pdf <- data.frame(x = x, Value = y_pdf, Function = rep('PDF', length(y_pdf)))
weibull_cdf <- data.frame(x = x, Value = y_cdf, Function = rep('CDF', length(y_cdf)))

full_df <- rbind(weibull_pdf, weibull_cdf)

ggplot(data = full_df) +
  geom_line(aes(x = x, y = Value), linewidth = 1) +
  facet_wrap(~ Function, ncol = 2) +
  ggtitle('PDF and CDF of a Weibull Distribution') +
  theme_bw()

```

f) Generate 500 samples, each of size 30, from an exponential random variable with lambda = 1.5. Compute the mean of these samples, and plot the distribution. Based on your knowledge of the Central Limit Theorem, is the distribution what you expected?


```{r}
# Answer:
expFun = function(size, lambda, n){
  samp_means = rep(0, n)
  for (i in 1:n){
    samp_means[i] = mean(rexp(size, lambda))
  }
  return(samp_means)
}

means = expFun(30, 1.5, 500)

ggplot() +
  geom_density(aes(x = means))
```

The distribution is about what I expected. I expected it to look close to normal since it's a fairly large sample size, and it does.